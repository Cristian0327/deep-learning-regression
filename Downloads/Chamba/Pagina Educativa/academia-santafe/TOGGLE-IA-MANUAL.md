# ğŸ”€ Toggle IA vs Manual en Bloques de EvaluaciÃ³n

## ğŸ“‹ DescripciÃ³n

Se agregÃ³ un **selector visual** en los bloques de evaluaciÃ³n para que el administrador pueda elegir entre dos mÃ©todos de creaciÃ³n de preguntas:

1. **ğŸ¤– Generar con IA** - Genera preguntas automÃ¡ticamente basadas en el contenido
2. **âœï¸ Crear Manualmente** - Agrega preguntas una por una de forma tradicional

---

## ğŸ¨ Interfaz

### Vista del Toggle

Cuando editas un **Bloque de EvaluaciÃ³n**, ahora aparece primero este selector:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿CÃ³mo quieres crear las preguntas?                        â”‚
â”‚                                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚  ğŸ¤–                  â”‚  â”‚  âœï¸                   â”‚       â”‚
â”‚ â”‚  Generar con IA      â”‚  â”‚  Crear Manualmente   â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Modo IA Seleccionado

Si seleccionas **ğŸ¤– Generar con IA**, aparece:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Generador de Preguntas con IA                           â”‚
â”‚                                                             â”‚
â”‚ ğŸ’¡ Instrucciones:                                          â”‚
â”‚   â€¢ La IA generarÃ¡ preguntas basadas en el contenido       â”‚
â”‚   â€¢ Configura el contenido de este bloque primero          â”‚
â”‚   â€¢ Las preguntas se crearÃ¡n con retroalimentaciÃ³n         â”‚
â”‚   â€¢ PodrÃ¡s editarlas antes de agregarlas                   â”‚
â”‚                                                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚ âœ¨ Generar Preguntas con IA     â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Modo Manual Seleccionado

Si seleccionas **âœï¸ Crear Manualmente**, aparece:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Preguntas de la EvaluaciÃ³n (0)    [+ Agregar Pregunta]    â”‚
â”‚                                                             â”‚
â”‚ No hay preguntas. Agrega una usando el botÃ³n de arriba.    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ImplementaciÃ³n TÃ©cnica

### Archivo Modificado

**`components/ConstructorCurso.tsx`**

### Estado Agregado

```typescript
const [modoCreacionPreguntas, setModoCreacionPreguntas] = useState<'ia' | 'manual'>('manual');
```

Por defecto inicia en **'manual'** para mantener compatibilidad con el flujo existente.

### CÃ³digo del Toggle

```tsx
<div className="bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-4 border-2 border-purple-200">
  <label className="block text-sm font-bold text-gray-800 mb-3">
    Â¿CÃ³mo quieres crear las preguntas?
  </label>
  <div className="grid grid-cols-2 gap-3">
    {/* BotÃ³n IA */}
    <button
      type="button"
      onClick={() => setModoCreacionPreguntas('ia')}
      className={modoCreacionPreguntas === 'ia' 
        ? 'bg-purple-600 text-white shadow-lg scale-105'
        : 'bg-white text-gray-700 hover:bg-purple-50'}
    >
      ğŸ¤– Generar con IA
    </button>
    
    {/* BotÃ³n Manual */}
    <button
      type="button"
      onClick={() => setModoCreacionPreguntas('manual')}
      className={modoCreacionPreguntas === 'manual'
        ? 'bg-green-600 text-white shadow-lg scale-105'
        : 'bg-white text-gray-700 hover:bg-green-50'}
    >
      âœï¸ Crear Manualmente
    </button>
  </div>
</div>
```

### Renderizado Condicional

```tsx
{/* BotÃ³n "Agregar" solo en modo Manual */}
{modoCreacionPreguntas === 'manual' && (
  <button onClick={agregarPreguntaQuiz}>
    + Agregar Pregunta
  </button>
)}

{/* Panel de IA solo cuando estÃ¡ seleccionado */}
{modoCreacionPreguntas === 'ia' && (
  <div className="bg-purple-50 ...">
    {/* UI de generaciÃ³n con IA */}
  </div>
)}
```

---

## ğŸ¯ Flujo de Uso

### Escenario 1: Crear Preguntas con IA

1. **Crear bloque de evaluaciÃ³n**
   - Click en "EvaluaciÃ³n" en el Constructor de Curso

2. **Configurar contenido del bloque**
   - Agregar descripciÃ³n de la evaluaciÃ³n
   - Escribir contenido relevante (opcional)

3. **Seleccionar modo IA**
   - Click en "ğŸ¤– Generar con IA"

4. **Generar preguntas**
   - Click en "âœ¨ Generar Preguntas con IA"
   - Esperar respuesta de la IA

5. **Revisar y editar**
   - Ver preguntas generadas
   - Editar las que necesiten ajustes
   - Agregar al bloque

### Escenario 2: Crear Preguntas Manualmente

1. **Crear bloque de evaluaciÃ³n**

2. **Mantener modo Manual** (es el predeterminado)
   - El toggle ya estÃ¡ en "âœï¸ Crear Manualmente"

3. **Agregar preguntas**
   - Click en "+ Agregar Pregunta"
   - Llenar formulario (pregunta, opciones, respuesta correcta)
   - Repetir para cada pregunta

---

## ğŸ¨ Estilos y Animaciones

### Estados del Toggle

**BotÃ³n Activo:**
- Fondo: Purple-600 (IA) o Green-600 (Manual)
- Texto: Blanco
- Sombra: `shadow-lg`
- Escala: `scale-105` (ligeramente mÃ¡s grande)

**BotÃ³n Inactivo:**
- Fondo: Blanco
- Texto: Gris
- Borde: Purple-200 (IA) o Green-200 (Manual)
- Hover: Fondo de color claro

### Transiciones

```css
transition-all /* Todas las propiedades se animan */
```

---

## ğŸ’¡ Funcionalidad Actual

### Estado: âš ï¸ PARCIALMENTE IMPLEMENTADO

**âœ… Completado:**
- Toggle funcional con 2 opciones
- UI responsiva y animada
- Renderizado condicional del botÃ³n "Agregar"
- Panel de IA con instrucciones

**â³ Pendiente:**
- Conectar botÃ³n "Generar" con el backend
- Integrar con el panel de IA de AdminCursos
- Pasar contenido del bloque a la funciÃ³n de generaciÃ³n
- Mostrar preguntas generadas en el bloque
- Funcionalidad de ediciÃ³n en el bloque

---

## ğŸ”® PrÃ³ximos Pasos

### 1. Conectar con Backend

Modificar el botÃ³n de "Generar Preguntas con IA" para que:

```typescript
const generarPreguntasBloque = async () => {
  // Validar que haya contenido en el bloque
  if (!bloqueSeleccionado?.contenido?.trim()) {
    alert('Debes agregar contenido al bloque primero');
    return;
  }

  // Llamar al endpoint de IA
  const response = await fetch('/api/generar-preguntas', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      contenidoCurso: bloqueSeleccionado.contenido,
      tiposPreguntas: {
        opcion2: 2,
        opcion3: 0,
        opcion4: 3,
        opcion5: 0
      }
    })
  });

  const { preguntas } = await response.json();
  
  // Actualizar el bloque con las preguntas generadas
  actualizarBloque({
    ...bloqueSeleccionado,
    preguntas: [...(bloqueSeleccionado.preguntas || []), ...preguntas]
  });
};
```

### 2. ConfiguraciÃ³n de Tipos

Agregar inputs antes del botÃ³n de generaciÃ³n para que el admin configure:

```tsx
<div className="grid grid-cols-4 gap-2 mb-3">
  <input type="number" placeholder="2 opciones" />
  <input type="number" placeholder="3 opciones" />
  <input type="number" placeholder="4 opciones" />
  <input type="number" placeholder="5 opciones" />
</div>
```

### 3. PrevisualizaciÃ³n

Mostrar las preguntas generadas antes de agregarlas al bloque:

```tsx
{preguntasGeneradasTemp.length > 0 && (
  <div className="bg-white rounded-lg p-4 mt-4">
    <h5>Preguntas Generadas ({preguntasGeneradasTemp.length})</h5>
    {preguntasGeneradasTemp.map((p, idx) => (
      <div key={idx}>
        <p>{p.pregunta}</p>
        <button onClick={() => editarPregunta(idx)}>âœï¸ Editar</button>
        <button onClick={() => agregarPregunta(p)}>+ Agregar</button>
      </div>
    ))}
  </div>
)}
```

---

## ğŸ§ª Testing

### Casos de Prueba

**Test 1: Toggle entre modos**
- âœ… Click en "IA" â†’ Panel de IA visible, botÃ³n "Agregar" oculto
- âœ… Click en "Manual" â†’ BotÃ³n "Agregar" visible, panel de IA oculto

**Test 2: Estado por defecto**
- âœ… Al crear nuevo bloque â†’ Modo "Manual" seleccionado

**Test 3: Persistencia del modo**
- â³ Al cambiar de modo y volver al bloque â†’ Â¿Se mantiene el modo?

**Test 4: Compatibilidad**
- âœ… Bloques antiguos sin el estado â†’ Funcionan en modo Manual

---

## ğŸ“± Responsive Design

El toggle funciona en todos los tamaÃ±os:

**Desktop (>768px):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– Generar con IA   â”‚  â”‚  âœï¸ Crear Manualmente â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Mobile (<768px):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– Generar con IA           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœï¸ Crear Manualmente         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Usa `grid-cols-2` que se adapta automÃ¡ticamente.

---

## âš™ï¸ Variables de ConfiguraciÃ³n

### Valores por Defecto

```typescript
// Estado inicial del modo
const MODO_DEFAULT = 'manual';

// Colores del tema IA
const COLOR_IA_ACTIVO = 'bg-purple-600';
const COLOR_IA_INACTIVO = 'bg-purple-50';

// Colores del tema Manual
const COLOR_MANUAL_ACTIVO = 'bg-green-600';
const COLOR_MANUAL_INACTIVO = 'bg-green-50';
```

---

## ğŸ› Problemas Conocidos

### 1. **BotÃ³n de IA no funcional**
**Estado:** Placeholder con alert()
**SoluciÃ³n:** Implementar en prÃ³xima iteraciÃ³n

### 2. **Sin persistencia del modo seleccionado**
**Estado:** Al cambiar de bloque, vuelve a 'manual'
**SoluciÃ³n:** PodrÃ­a guardarse en el estado del bloque

---

## ğŸ“Š ComparaciÃ³n: Antes vs Ahora

### ANTES

```tsx
{/* Solo tenÃ­as un botÃ³n fijo */}
<button onClick={agregarPreguntaQuiz}>
  + Agregar Pregunta
</button>
```

### AHORA

```tsx
{/* Tienes opciÃ³n de elegir */}
<div>
  {/* Toggle IA vs Manual */}
  <ToggleSelector />
  
  {/* Renderiza segÃºn selecciÃ³n */}
  {modo === 'ia' ? <PanelIA /> : <BotonAgregar />}
</div>
```

---

## ğŸ¯ Beneficios

### Para el Administrador

1. **Flexibilidad**: Elige el mÃ©todo que prefiera
2. **Rapidez**: Genera mÃºltiples preguntas con IA en segundos
3. **Control**: Puede crear preguntas especÃ­ficas manualmente
4. **Mezcla**: Puede usar ambos mÃ©todos en el mismo curso

### Para el Sistema

1. **Escalabilidad**: FÃ¡cil agregar mÃ¡s modos en el futuro
2. **UX clara**: Toggle visual e intuitivo
3. **SeparaciÃ³n de responsabilidades**: IA y Manual independientes
4. **Compatibilidad**: No rompe funcionalidad existente

---

## ğŸ“š Archivos Relacionados

1. **`components/ConstructorCurso.tsx`** - Toggle implementado aquÃ­
2. **`app/AdminCursos/page.tsx`** - Panel de IA principal (para referenciar)
3. **`netlify/functions/generar-preguntas.js`** - Backend de IA
4. **`CAMBIOS-PANEL-IA.md`** - DocumentaciÃ³n del sistema de IA

---

## âœ… Checklist de ImplementaciÃ³n

- [x] Estado del toggle agregado
- [x] UI del toggle diseÃ±ada y funcional
- [x] Renderizado condicional del botÃ³n "Agregar"
- [x] Panel de IA con instrucciones
- [x] Estilos y animaciones
- [x] Responsive design
- [ ] Conectar botÃ³n de IA con backend
- [ ] ConfiguraciÃ³n de tipos de preguntas en bloque
- [ ] PrevisualizaciÃ³n de preguntas generadas
- [ ] EdiciÃ³n de preguntas en el bloque
- [ ] Persistencia del modo seleccionado
- [ ] Testing completo

---

## ğŸš€ Estado Actual

**VersiÃ³n:** 1.0 (Beta)  
**Fecha:** 23 de Diciembre 2025  
**Estado:** âœ… Toggle funcional, â³ Backend pendiente  

El toggle estÃ¡ **listo para usarse** visualmente. La funcionalidad de IA se completarÃ¡ conectÃ¡ndola con el sistema existente de `AdminCursos/page.tsx`.
